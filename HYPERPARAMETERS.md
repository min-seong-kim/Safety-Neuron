# neuron_detection_fixed.py - ν•μ΄νΌνλΌλ―Έν„° μ •λ¦¬

## 1. λ¨λΈ μ„¤μ •
| νλΌλ―Έν„° | κ°’ | μ„¤λ… |
|---------|-----|------|
| `model_name` | `"meta-llama/Llama-3.1-8B-Instruct"` | μ‚¬μ©ν•  LLM λ¨λΈ |
| `device_map` | `"auto"` | μλ™ λ””λ°”μ΄μ¤ ν• λ‹Ή (GPU μ°μ„ ) |

## 2. ν† ν¬λ‚μ΄μ € μ„¤μ •
| νλΌλ―Έν„° | κ°’ | μ„¤λ… |
|---------|-----|------|
| `pad_token` | `tokenizer.eos_token` | ν¨λ”© ν† ν° (μ—†μΌλ©΄ EOS ν† ν° μ‚¬μ©) |
| `max_length` | `512` | μµλ€ μ‹ν€€μ¤ κΈΈμ΄ |
| `padding` | `True` | μ‹ν€€μ¤ ν¨λ”© ν™μ„±ν™” |
| `truncation` | `True` | κΈ΄ μ‹ν€€μ¤ μλ¥΄κΈ° |

## 3. λ‰΄λ° ν™μ„±ν™” κ°μ§€ μ„¤μ •
| νλΌλ―Έν„° | κ°’ | μ„¤λ… |
|---------|-----|------|
| `activation_threshold` | `0.1` | λ‰΄λ° ν™μ„±ν™” νλ‹¨ μ„κ³„κ°’ |
| `top_number_attn` | `1000` | μ„ νƒν•  μƒμ„ μ£Όμλ ¥ λ‰΄λ° κ°μ |
| `top_number_ffn` | `2000` | μ„ νƒν•  μƒμ„ FFN λ‰΄λ° κ°μ |

## 4. λ¨λΈ κµ¬μ΅° μ„¤μ •
| νλΌλ―Έν„° | κ°’ | μ„¤λ… |
|---------|-----|------|
| `candidate_premature_layers` | `[0, 1, ..., 31]` | κ²€μ‚¬ν•  λ μ΄μ–΄ λ²”μ„ (μ΄ 32κ°) |
| μ¶”μ  λ μ΄μ–΄ | FFN up/down, Attn Q/K/V/O | κ° λ μ΄μ–΄μ—μ„ μ¶”μ ν•  μ»΄ν¬λ„νΈ |

## 5. μƒμ„± μ„¤μ •
| νλΌλ―Έν„° | κ°’ | μ„¤λ… |
|---------|-----|------|
| `max_new_tokens` | `1` | μƒμ„±ν•  μµλ€ ν† ν° μ (λ‹µλ³€ κ²€μ¦μ©) |
| `do_sample` | `False` | κ²°μ •λ΅ μ  μƒμ„± (μ¨λ„ κΈ°λ° μƒν”λ§ λΉ„ν™μ„±ν™”) |

## 6. λ°μ΄ν„° μ²λ¦¬ μ„¤μ •
| νλΌλ―Έν„° | κ°’ | μ„¤λ… |
|---------|-----|------|
| `random_seed` | `112` | λ‚μ μƒμ„± μ‹λ“ |
| μƒν”λ§ | `random.sample()` | λ¬΄μ‘μ„ μƒν” μ„ νƒ |

## 7. μ¶λ ¥ μ„¤μ •
| νλΌλ―Έν„° | κ°’ | μ„¤λ… |
|---------|-----|------|
| `output_dir` | `"./output_neurons"` | λ‰΄λ° κ°μ§€ κ²°κ³Ό μ €μ¥ λ””λ ‰ν† λ¦¬ |
| νμΌλ… ν•μ‹ | `{model}_{dataset}_{count}.txt` | λ¨λΈλ…_λ°μ΄ν„°μ…‹_μ²λ¦¬μ |

## μ£Όμ” ν•μ΄νΌνλΌλ―Έν„°λ³„ μν–¥λ„

### π”΄ λ†’μ€ μν–¥λ„
- **`activation_threshold`** (0.1): λ‰΄λ° ν™μ„±ν™” νλ‹¨ κΈ°μ¤€ - κ°’μ΄ λ‚®μΌλ©΄ λ” λ§μ€ λ‰΄λ° κ°μ§€, λ†’μΌλ©΄ μ£Όμ” λ‰΄λ°λ§ κ°μ§€
- **`top_number_ffn`** (2000): FFN λ‰΄λ° κ°μ - λ©”λ¨λ¦¬ μ‚¬μ©λ‰κ³Ό κ°μ§€ μ •ν™•λ„μ— μ§μ ‘ μν–¥
- **`top_number_attn`** (1000): μ£Όμλ ¥ λ‰΄λ° κ°μ - λ¨λΈμ μ£Όμ λ©”μ»¤λ‹μ¦ λ¶„μ„ λ²”μ„ κ²°μ •

### π΅ μ¤‘κ°„ μν–¥λ„
- **`max_length`** (512): ν† ν¬λ‚μ΄μ € μ…λ ¥ κΈΈμ΄ - ν”„λ΅¬ν”„νΈ λ‹¤μ–‘μ„± μν–¥
- **`max_new_tokens`** (1): μƒμ„± κΈΈμ΄ - κ³„μ‚° λΉ„μ© μµμ†ν™”

### πΆ λ‚®μ€ μν–¥λ„
- **`pad_token`**: λ°°μΉ μ²λ¦¬ ν•„μ”μ‹λ§ μν–¥
- **`device_map`**: "auto" κ³ μ • (μλ™ μµμ ν™”)

## μ¶”μ² μ΅°μ • λ²”μ„

| νλΌλ―Έν„° | μµμ† | κΈ°λ³Έ | μµλ€ | μ©λ„ |
|---------|------|------|------|------|
| `activation_threshold` | 0.01 | 0.1 | 0.5 | λ” μ—„κ²©ν•/λμ¨ν• κ°μ§€ |
| `top_number_ffn` | 1000 | 2000 | 5000 | λ©”λ¨λ¦¬/μ •ν™•λ„ νΈλ μ΄λ“μ¤ν”„ |
| `top_number_attn` | 500 | 1000 | 2000 | μ£Όμλ ¥ μ„Έλ°€λ„ μ΅°μ • |
| `max_length` | 256 | 512 | 1024 | μ…λ ¥ κΈΈμ΄ λ²”μ„ |
